# Character Image Upload Fix Implementation Plan

## Goal Description
Fix the issue where character standing pictures (t立ち絵) cannot be uploaded in the admin panel's character management section.

## User Review Required
None identified yet.

## Proposed Changes
## Proposed Changes
### Admin Panel
- [app/admin/page.js](file:///c:/Users/kouki/.gemini/hifuu-kou-club/app/admin/page.js):
    - [x] **Fix Bug**: Change `c.image` to `c.image_url` in the character list mapping.
    - [x] **Fix Bug**: Change `char.image` to `char.image_url` in [handleEditChar](file:///c:/Users/kouki/.gemini/hifuu-kou-club/app/admin/page.js#197-209).

### Public Site
- [components/CharacterSection.js](file:///c:/Users/kouki/.gemini/hifuu-kou-club/components/CharacterSection.js):
    - [ ] **Fix Bug**: Change `char.image` to `char.image_url` in the avatar list.
    - [ ] **Fix Bug**: Change `selectedChar.image` to `selectedChar.image_url` in the main display.

### API Routes
- [app/api/upload/route.js](file:///c:/Users/kouki/.gemini/hifuu-kou-club/app/api/upload/route.js):
    - [x] **Fix Upload Logic**: Import and use `supabaseAdmin` instead of `supabase` to bypass RLS, ensuring uploads work for authenticated admins.
    - [x] Add fallback: If `supabaseAdmin` is null (missing env var), log error or try standard `supabase` (though likely to fail if RLS is strict).
- [app/api/characters/route.js](file:///c:/Users/kouki/.gemini/hifuu-kou-club/app/api/characters/route.js):
    - [ ] No changes needed if data structure remains `image_url`.

## Verification Plan
### Manual Verification
- Attempt to upload an image for a new and existing character via the admin panel.
- Verify the image appears in the list and on the public site (if applicable).
